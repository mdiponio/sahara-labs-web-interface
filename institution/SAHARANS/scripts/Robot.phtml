<?php
/**
 * Robot web interface.
 */

$this->headScript()->appendFile($this->baseUrl('webui/webui.js'));
$this->headLink()->appendStylesheet($this->baseUrl('webui/webui.css'));
$this->headLink()->appendStylesheet($this->baseUrl('webui/webui-flat.css'));

$this->headScript()->appendFile($this->baseUrl('uts/robot/robot-imperative.js'));
$this->headLink()->appendStylesheet($this->baseUrl('uts/robot/robot.css'));

/* Canvas compatability implementation for Internet Explorer 8 and earlier. */
$this->headScript()->appendFile($this->baseUrl('js/excanvas.js'),
        'text/javascript',
        array('conditional' => 'lt IE 9')
);
?>

<div id="robot-anchor">
    <!-- Interface goes here! -->
</div>


<script type="text/javascript">
$(document).ready(function() {
    var dp;
    new WebUIApp({
        anchor: "#robot-anchor",
        windowToggle: true,
        controller: "RobotController",
        dataAction: "data",
        theme: Globals.THEME.flat	,
        cookie: "robot",
        dataPeriod: 100,
        dataDuration: 60,
        pollPeriod: 1000,
        height: 1350,
        widgets: [
			new CameraStream("overhead-camera", {
			    title: "Camera",
			    swfParam: "camera-swf-overhead",
			    mjpegParam: "camera-mjpeg-overhead",
			    webmParam: "camera-webm-overhead",
			    videoWidth: 512,
			    videoHeight: 384,
			    left: 136,
			    top: 0
			}),
			new CameraControl("camera-control", {
				title: "Camera View",
				width: 225,
				height: 160,
				left: -157,
				top: 145,
				resizable: false,
				expandable: false
			}),
			new AMCL("amcl", {
				title: "Map & AMCL",
				action: "setAMCLInitialPose",
				initialPoseField: "amcl-initial-pose",
				poseField: "amcl-pose",
				particlesField: "amcl-particles",
				tfField: "tf",
				width: 679,
				height: 395,
				left: -16,
				top: 860,
				resizable: false,
				expandable: false,
			}),
            dp = new DPad("dpad", {
                title: "Movement",
               	action: "setSpeed",
                speedField: "robot-linear",
                yawField: "robot-angular",
                windowed: false,
                top: 320,
                left: -110
            }),
            new Ranger("ranger-panel", {
                title: "Hokuyo",
                width: 330,
                height: 360,
                left: -210,
                top: 480
            }),
            new CodeUpload("code-upload", {
				title: "ROS Upload",
				width: 522,
				height: 360,
				expandable: false,
				dpad: dp,
				top: 480,
				left: 136
            }),
            new InitError(),
        ]
    }).setup().run();
});
</script>

<iframe style="display:none" id="code-upload-target" name="code-upload-frame"></iframe>
